"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[958],{3608:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"ros2-basics/nodes-topics","title":"ROS 2 Nodes, Topics, Services, and Actions","description":"This section provides a deeper dive into the core communication patterns in ROS 2: nodes, topics, services, and actions. Understanding these concepts is essential for building modular, distributed robotic applications.","source":"@site/docs/02-ros2-basics/nodes-topics.md","sourceDirName":"02-ros2-basics","slug":"/ros2-basics/nodes-topics","permalink":"/Hackthon_SpecKitPlus/docs/ros2-basics/nodes-topics","draft":false,"unlisted":false,"editUrl":"https://github.com/shaheryarshah/Hackthon_SpecKitPlus/edit/main/docs/docs/02-ros2-basics/nodes-topics.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Introduction to ROS 2 - The Robotic Nervous System","permalink":"/Hackthon_SpecKitPlus/docs/ros2-basics/intro"},"next":{"title":"URDF Modeling for Robotics","permalink":"/Hackthon_SpecKitPlus/docs/ros2-basics/urdf"}}');var o=s(4848),t=s(8453);const r={},c="ROS 2 Nodes, Topics, Services, and Actions",a={},l=[{value:"Learning Outcomes",id:"learning-outcomes",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"Nodes - The Foundation of ROS 2",id:"nodes---the-foundation-of-ros-2",level:3},{value:"Topics - Asynchronous Communication",id:"topics---asynchronous-communication",level:3},{value:"Services - Synchronous Request-Response",id:"services---synchronous-request-response",level:3},{value:"Actions - Long-Running Tasks with Feedback",id:"actions---long-running-tasks-with-feedback",level:3},{value:"Equations and Models",id:"equations-and-models",level:2},{value:"Communication Patterns",id:"communication-patterns",level:3},{value:"Quality of Service Model",id:"quality-of-service-model",level:3},{value:"Code Example: Advanced Communication Patterns",id:"code-example-advanced-communication-patterns",level:2},{value:"Simulation Demonstration",id:"simulation-demonstration",level:2},{value:"Hands-On Lab: Implementing All Communication Patterns",id:"hands-on-lab-implementing-all-communication-patterns",level:2},{value:"Required Equipment:",id:"required-equipment",level:3},{value:"Instructions:",id:"instructions",level:3},{value:"Common Pitfalls &amp; Debugging Notes",id:"common-pitfalls--debugging-notes",level:2},{value:"Summary &amp; Key Terms",id:"summary--key-terms",level:2},{value:"Further Reading &amp; Citations",id:"further-reading--citations",level:2},{value:"Assessment Questions",id:"assessment-questions",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"ros-2-nodes-topics-services-and-actions",children:"ROS 2 Nodes, Topics, Services, and Actions"})}),"\n",(0,o.jsx)(n.p,{children:"This section provides a deeper dive into the core communication patterns in ROS 2: nodes, topics, services, and actions. Understanding these concepts is essential for building modular, distributed robotic applications."}),"\n",(0,o.jsx)(n.h2,{id:"learning-outcomes",children:"Learning Outcomes"}),"\n",(0,o.jsx)(n.p,{children:"After completing this section, you should be able to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Design appropriate communication patterns for different robotic tasks"}),"\n",(0,o.jsx)(n.li,{children:"Implement nodes that communicate via topics, services, and actions"}),"\n",(0,o.jsx)(n.li,{children:"Understand when to use each communication pattern"}),"\n",(0,o.jsx)(n.li,{children:"Configure Quality of Service (QoS) settings appropriately"}),"\n",(0,o.jsx)(n.li,{children:"Debug communication issues in ROS 2 applications"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,o.jsx)(n.h3,{id:"nodes---the-foundation-of-ros-2",children:"Nodes - The Foundation of ROS 2"}),"\n",(0,o.jsx)(n.p,{children:"A node is a fundamental component of ROS 2 that performs computation. Each node is typically responsible for one specific task and communicates with other nodes through topics, services, or actions. Nodes run in isolation but work together to achieve complex robotic behaviors."}),"\n",(0,o.jsx)(n.h3,{id:"topics---asynchronous-communication",children:"Topics - Asynchronous Communication"}),"\n",(0,o.jsx)(n.p,{children:"Topics enable asynchronous, many-to-many communication using a publish-subscribe pattern. Publishers send messages to topics without knowing which subscribers will receive them. Subscribers receive messages from topics without knowing which publishers sent them. This loose coupling allows for flexible system architecture."}),"\n",(0,o.jsx)(n.h3,{id:"services---synchronous-request-response",children:"Services - Synchronous Request-Response"}),"\n",(0,o.jsx)(n.p,{children:"Services enable synchronous, one-to-one communication using a request-response pattern. A client sends a request to a service server and waits for a response. The communication is blocking, meaning the client waits for the complete response before continuing."}),"\n",(0,o.jsx)(n.h3,{id:"actions---long-running-tasks-with-feedback",children:"Actions - Long-Running Tasks with Feedback"}),"\n",(0,o.jsx)(n.p,{children:"Actions are designed for tasks that take a significant amount of time to complete and may be preempted. Actions provide feedback during execution and send a result when complete. They support goals, which can be sent, canceled, or modified during execution."}),"\n",(0,o.jsx)(n.h2,{id:"equations-and-models",children:"Equations and Models"}),"\n",(0,o.jsx)(n.h3,{id:"communication-patterns",children:"Communication Patterns"}),"\n",(0,o.jsx)(n.p,{children:"The communication patterns can be expressed as:"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Topics (Publish-Subscribe)"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"p_i \u2192 t_j \u2192 {s_k1, s_k2, ..., s_km}\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Services (Request-Response)"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"c_i \u2192 req \u2192 s_j \u2192 res \u2192 c_i\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Actions (Goal-Feedback-Result)"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"c_i \u2192 goal \u2192 s_j \u2192 {feedback}^n \u2192 result \u2192 c_i\n"})}),"\n",(0,o.jsx)(n.h3,{id:"quality-of-service-model",children:"Quality of Service Model"}),"\n",(0,o.jsx)(n.p,{children:"QoS policies in ROS 2 can be modeled as:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"QoS = {reliability, durability, history, depth, ...}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Where reliability can be ",(0,o.jsx)(n.code,{children:"RELIABLE"})," or ",(0,o.jsx)(n.code,{children:"BEST_EFFORT"}),", durability can be ",(0,o.jsx)(n.code,{children:"TRANSIENT_LOCAL"})," or ",(0,o.jsx)(n.code,{children:"VOLATILE"}),", etc."]}),"\n",(0,o.jsx)(n.h2,{id:"code-example-advanced-communication-patterns",children:"Code Example: Advanced Communication Patterns"}),"\n",(0,o.jsx)(n.p,{children:"Here's an example implementing all three communication patterns in ROS 2:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'import rclpy\nfrom rclpy.node import Node\nfrom rclpy.action import ActionClient\nfrom rclpy.callback_groups import ReentrantCallbackGroup\nfrom rclpy.executors import MultiThreadedExecutor\n\n# Import standard message types\nfrom std_msgs.msg import String\nfrom example_interfaces.srv import AddTwoInts\nfrom example_interfaces.action import Fibonacci\n\n\nclass RobotCommunicationNode(Node):\n    def __init__(self):\n        super().__init__(\'robot_communication_node\')\n        \n        # Topic publisher for robot status\n        self.status_publisher = self.create_publisher(String, \'robot_status\', 10)\n        \n        # Topic subscriber for commands\n        self.command_subscription = self.create_subscription(\n            String, \'robot_commands\', self.command_callback, 10)\n        \n        # Service server for simple calculations\n        self.service = self.create_service(\n            AddTwoInts, \'add_two_ints\', self.add_two_ints_callback)\n        \n        # Action client for navigation tasks\n        self.action_client = ActionClient(\n            self, Fibonacci, \'fibonacci_action\')\n        \n        # Timer to periodically publish status\n        self.timer = self.create_timer(1.0, self.publish_status)\n        self.status_counter = 0\n        \n    def publish_status(self):\n        """Publish robot status periodically"""\n        msg = String()\n        msg.data = f\'Robot status update {self.status_counter}\'\n        self.status_publisher.publish(msg)\n        self.status_counter += 1\n        \n    def command_callback(self, msg):\n        """Handle incoming commands"""\n        self.get_logger().info(f\'Received command: {msg.data}\')\n        \n        # Process command based on content\n        if \'calculate_fibonacci\' in msg.data:\n            self.send_fibonacci_goal()\n    \n    def add_two_ints_callback(self, request, response):\n        """Service callback for adding two integers"""\n        result = request.a + request.b\n        response.sum = result\n        self.get_logger().info(f\'{request.a} + {request.b} = {response.sum}\')\n        return response\n    \n    def send_fibonacci_goal(self):\n        """Send a goal to the Fibonacci action server"""\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = 10\n        \n        # Wait for action server\n        self.action_client.wait_for_server()\n        \n        # Send goal\n        self._send_goal_future = self.action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback)\n        \n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n    \n    def goal_response_callback(self, future):\n        """Handle response from action server"""\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info(\'Goal rejected\')\n            return\n\n        self.get_logger().info(\'Goal accepted\')\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def feedback_callback(self, feedback_msg):\n        """Handle feedback from action server"""\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f\'Received feedback: {feedback.sequence}\')\n\n    def get_result_callback(self, future):\n        """Handle result from action server"""\n        result = future.result().result\n        self.get_logger().info(f\'Result: {result.sequence}\')\n        # Publish result as a status\n        result_msg = String()\n        result_msg.data = f\'Fibonacci result: {result.sequence}\'\n        self.status_publisher.publish(result_msg)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    \n    # Create node\n    comm_node = RobotCommunicationNode()\n    \n    # Use multi-threaded executor to handle multiple callbacks\n    executor = MultiThreadedExecutor()\n    executor.add_node(comm_node)\n    \n    try:\n        executor.spin()\n    except KeyboardInterrupt:\n        pass\n    finally:\n        comm_node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,o.jsx)(n.h2,{id:"simulation-demonstration",children:"Simulation Demonstration"}),"\n",(0,o.jsx)(n.p,{children:"This node demonstrates all three communication patterns in a single application. It publishes status updates as topics, responds to calculation requests via services, and manages long-running Fibonacci calculations via actions. The code can be run in a simulation environment to see how these different communication patterns interact."}),"\n",(0,o.jsx)(n.h2,{id:"hands-on-lab-implementing-all-communication-patterns",children:"Hands-On Lab: Implementing All Communication Patterns"}),"\n",(0,o.jsx)(n.p,{children:"In this lab, you'll implement a node that uses all three communication patterns:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Create a node with publishers and subscribers"}),"\n",(0,o.jsx)(n.li,{children:"Add a service server and client"}),"\n",(0,o.jsx)(n.li,{children:"Implement an action server and client"}),"\n",(0,o.jsx)(n.li,{children:"Test the communication patterns in simulation"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"required-equipment",children:"Required Equipment:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"ROS 2 Humble environment"}),"\n",(0,o.jsx)(n.li,{children:"Python development environment"}),"\n",(0,o.jsx)(n.li,{children:"(Optional) Gazebo simulation environment"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"instructions",children:"Instructions:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Create a new ROS 2 package for the lab"}),"\n",(0,o.jsx)(n.li,{children:"Implement the RobotCommunicationNode as shown in the code example"}),"\n",(0,o.jsxs)(n.li,{children:["Create a separate service server if needed: ",(0,o.jsx)(n.code,{children:"ros2 run example_interfaces add_two_ints_server"})]}),"\n",(0,o.jsxs)(n.li,{children:["Create a separate action server for Fibonacci: ",(0,o.jsx)(n.code,{children:"ros2 run example_interfaces fibonacci_action_server"})]}),"\n",(0,o.jsxs)(n.li,{children:["Run the communication node: ",(0,o.jsx)(n.code,{children:"ros2 run [your_package] robot_communication_node"})]}),"\n",(0,o.jsxs)(n.li,{children:["Test the different communication patterns:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Send a command via topic: ",(0,o.jsx)(n.code,{children:"ros2 topic pub /robot_commands std_msgs/String \"data: 'calculate_fibonacci'\""})]}),"\n",(0,o.jsxs)(n.li,{children:["Send a service request: ",(0,o.jsx)(n.code,{children:'ros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 2, b: 3}"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Observe the status publications: ",(0,o.jsx)(n.code,{children:"ros2 topic echo /robot_status std_msgs/String"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:"Analyze how each communication pattern serves different purposes"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"common-pitfalls--debugging-notes",children:"Common Pitfalls & Debugging Notes"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Quality of Service Mismatch"}),": Publishers and subscribers must have compatible QoS settings to communicate"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Node Discovery"}),": In distributed systems, ensure nodes can discover each other across the network"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Threading Issues"}),": Use appropriate callback groups (ReentrantCallbackGroup, MutuallyExclusiveCallbackGroup) for multi-threaded scenarios"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Action Preemption"}),": Consider how to handle goal preemption in action servers"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Message Compatibility"}),": Ensure all nodes use compatible message definitions"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"summary--key-terms",children:"Summary & Key Terms"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Key Terms:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Publish-Subscribe"}),": Asynchronous communication pattern where publishers send messages to topics and subscribers receive them"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Request-Response"}),": Synchronous communication pattern where clients send requests to services and receive responses"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Action"}),": Asynchronous communication pattern for long-running tasks with feedback and cancelation"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Quality of Service (QoS)"}),": Settings that govern ROS 2 communication behavior"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Callback Groups"}),": Mechanisms to control how callbacks are executed in multi-threaded scenarios"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Action Server"}),": The node that executes action goals"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Action Client"}),": The node that sends action goals"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"further-reading--citations",children:"Further Reading & Citations"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:['ROS 2 Documentation. (2023). "Tutorials: Understanding Quality of Service." ',(0,o.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Quality-Of-Service.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Quality-Of-Service.html"})]}),"\n",(0,o.jsxs)(n.li,{children:['ROS 2 Documentation. (2023). "Concepts: About Communications." ',(0,o.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts/About-Topics.html",children:"https://docs.ros.org/en/humble/Concepts/About-Topics.html"})]}),"\n",(0,o.jsx)(n.li,{children:"Kamran, M. A. (2021). ROS Robotics Projects. Packt Publishing."}),"\n",(0,o.jsx)(n.li,{children:"Jung, J. (2019). ROS Robot Programming. CreateSpace."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"assessment-questions",children:"Assessment Questions"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Explain the differences between topics, services, and actions in ROS 2. Provide an example of when you would use each communication pattern."}),"\n",(0,o.jsx)(n.li,{children:"What are Quality of Service (QoS) settings in ROS 2? Why are they important?"}),"\n",(0,o.jsx)(n.li,{children:"Describe the role of callback groups in ROS 2 multi-threaded applications."}),"\n",(0,o.jsx)(n.li,{children:"How does the action communication pattern differ from the service pattern in terms of execution and feedback?"}),"\n",(0,o.jsx)(n.li,{children:"What are some common debugging strategies for ROS 2 communication issues?"}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Previous"}),": ",(0,o.jsx)(n.a,{href:"/Hackthon_SpecKitPlus/docs/ros2-basics/intro",children:"Introduction to ROS 2"}),(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.strong,{children:"Next"}),": ",(0,o.jsx)(n.a,{href:"/Hackthon_SpecKitPlus/docs/ros2-basics/urdf",children:"URDF Modeling for Robotics"})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>c});var i=s(6540);const o={},t=i.createContext(o);function r(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);